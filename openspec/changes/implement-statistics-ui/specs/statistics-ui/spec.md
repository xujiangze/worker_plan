# statistics-ui Specification

## Purpose
定义统计分析功能的前端界面规范,包括数据展示、用户交互和可视化要求。

## ADDED Requirements

### Requirement: 显示完成率卡片
系统 MUST 在统计页面顶部显示完成率卡片,展示总体完成情况。

#### Scenario: 显示完成率卡片
**Given** 系统中存在 20 个工作计划,其中 12 个已完成
**When** 用户访问统计页面
**Then** 页面顶部显示完成率卡片
**And** 卡片显示完成率为 60%
**And** 卡片显示总计划数为 20
**And** 卡片显示已完成计划数为 12
**And** 卡片使用醒目的颜色和图标

#### Scenario: 显示完成率卡片时系统为空
**Given** 系统中不存在任何工作计划
**When** 用户访问统计页面
**Then** 页面顶部显示完成率卡片
**And** 卡片显示完成率为 0%
**And** 卡片显示总计划数为 0
**And** 卡片显示已完成计划数为 0

#### Scenario: 完成率卡片加载失败
**Given** 后端API返回错误
**When** 用户访问统计页面
**Then** 完成率卡片显示加载失败提示
**And** 提供重试按钮
**And** 点击重试按钮后重新加载数据

### Requirement: 显示状态分布饼图
系统 MUST 使用饼图展示各状态计划的分布情况。

#### Scenario: 显示状态分布饼图
**Given** 系统中存在 20 个工作计划,分布如下:
  - 待开始: 5 个
  - 进行中: 8 个
  - 已完成: 6 个
  - 已取消: 1 个
**When** 用户访问统计页面
**Then** 页面显示状态分布饼图
**And** 饼图包含 4 个扇区,分别对应 4 种状态
**And** 每个扇区显示对应的数量和百分比
**And** 饼图使用不同的颜色区分不同状态
**And** 饼图右侧显示图例

#### Scenario: 鼠标悬停状态饼图扇区
**Given** 页面显示状态分布饼图
**When** 用户将鼠标悬停在某个扇区上
**Then** 该扇区高亮显示
**And** 显示详细信息提示框,包含状态名称、数量和百分比

#### Scenario: 点击状态饼图图例
**Given** 页面显示状态分布饼图
**When** 用户点击某个状态的图例
**Then** 对应的扇区从饼图中隐藏
**And** 再次点击该图例,扇区重新显示

#### Scenario: 状态饼图数据为空
**Given** 系统中不存在任何工作计划
**When** 用户访问统计页面
**Then** 页面显示状态分布饼图
**And** 饼图显示为空状态
**And** 显示"暂无数据"提示

### Requirement: 显示优先级分布饼图
系统 MUST 使用饼图展示各优先级计划的分布情况。

#### Scenario: 显示优先级分布饼图
**Given** 系统中存在 20 个工作计划,分布如下:
  - 高优先级: 3 个
  - 中优先级: 10 个
  - 低优先级: 7 个
**When** 用户访问统计页面
**Then** 页面显示优先级分布饼图
**And** 饼图包含 3 个扇区,分别对应 3 种优先级
**And** 每个扇区显示对应的数量和百分比
**And** 饼图使用不同的颜色区分不同优先级
**And** 饼图右侧显示图例

#### Scenario: 鼠标悬停优先级饼图扇区
**Given** 页面显示优先级分布饼图
**When** 用户将鼠标悬停在某个扇区上
**Then** 该扇区高亮显示
**And** 显示详细信息提示框,包含优先级名称、数量和百分比

#### Scenario: 优先级饼图数据为空
**Given** 系统中不存在任何工作计划
**When** 用户访问统计页面
**Then** 页面显示优先级分布饼图
**And** 饼图显示为空状态
**And** 显示"暂无数据"提示

### Requirement: 显示时间趋势图
系统 MUST 使用折线图或柱状图展示指定时间范围内的创建和完成趋势。

#### Scenario: 显示时间趋势图
**Given** 系统中存在多个工作计划,创建和完成时间分布在 2026-01-01 至 2026-01-31 之间
**When** 用户访问统计页面
**Then** 页面显示时间趋势图
**And** 图表X轴显示日期
**And** 图表Y轴显示数量
**And** 图表包含两条折线/柱状,分别表示创建和完成数量
**And** 创建数量使用一种颜色
**And** 完成数量使用另一种颜色
**And** 图表顶部显示图例

#### Scenario: 鼠标悬停时间趋势图数据点
**Given** 页面显示时间趋势图
**When** 用户将鼠标悬停在某个数据点上
**Then** 显示详细信息提示框,包含日期、创建数量和完成数量

#### Scenario: 时间趋势图数据为空
**Given** 系统中不存在任何工作计划
**When** 用户访问统计页面
**Then** 页面显示时间趋势图
**And** 图表显示为空状态
**And** 显示"暂无数据"提示

#### Scenario: 时间趋势图数据点过多
**Given** 系统中存在大量工作计划,时间跨度超过 90 天
**When** 用户访问统计页面
**Then** 时间趋势图自动调整X轴显示
**And** 图表支持缩放和平移
**And** 图表性能保持流畅,不卡顿

### Requirement: 日期范围选择器
系统 MUST 提供日期范围选择器,允许用户选择自定义时间范围。

#### Scenario: 使用日期范围选择器
**Given** 用户访问统计页面
**When** 用户点击日期范围选择器
**Then** 显示日期选择面板
**And** 用户可以选择开始日期和结束日期
**And** 日期选择器显示日历视图
**And** 用户可以选择过去或未来的日期

#### Scenario: 选择日期范围后刷新图表
**Given** 用户访问统计页面
**When** 用户选择日期范围(如 2026-01-01 至 2026-01-31)
**And** 点击确认按钮
**Then** 系统发送API请求获取该时间范围的统计数据
**And** 时间趋势图更新为选定时间范围的数据
**And** 其他图表(状态、优先级)保持不变
**And** 页面显示加载状态,直到数据加载完成

#### Scenario: 选择无效日期范围
**Given** 用户访问统计页面
**When** 用户选择开始日期晚于结束日期
**And** 点击确认按钮
**Then** 系统显示错误提示
**And** 提示"开始日期不能晚于结束日期"
**And** 日期选择器保持当前选择,不发送API请求

#### Scenario: 日期范围选择器默认值
**Given** 用户访问统计页面
**When** 页面首次加载
**Then** 日期范围选择器显示默认值
**And** 默认范围为最近 30 天
**And** 时间趋势图显示最近 30 天的数据

### Requirement: 响应式布局
系统 MUST 支持响应式布局,在不同设备上都能良好显示。

#### Scenario: 桌面端布局
**Given** 用户使用桌面设备(屏幕宽度 >= 1024px)
**When** 用户访问统计页面
**Then** 页面采用双列布局
**And** 完成率卡片占据顶部一行
**And** 状态分布饼图和优先级分布饼图并排显示
**And** 时间趋势图占据底部一行

#### Scenario: 平板端布局
**Given** 用户使用平板设备(768px <= 屏幕宽度 < 1024px)
**When** 用户访问统计页面
**Then** 页面采用单列布局
**And** 完成率卡片占据顶部一行
**And** 状态分布饼图和优先级分布饼图垂直排列
**And** 时间趋势图占据底部一行

#### Scenario: 移动端布局
**Given** 用户使用移动设备(屏幕宽度 < 768px)
**When** 用户访问统计页面
**Then** 页面采用单列布局
**And** 所有组件垂直排列
**And** 图表自动调整大小以适应屏幕
**And** 日期范围选择器适配移动端交互

### Requirement: 加载状态和错误处理
系统 MUST 提供清晰的加载状态和错误处理机制。

#### Scenario: 页面加载中
**Given** 用户访问统计页面
**When** 数据正在加载
**Then** 页面显示加载指示器
**And** 加载指示器显示在图表位置
**And** 加载指示器使用动画效果

#### Scenario: API请求失败
**Given** 用户访问统计页面
**When** API请求失败
**Then** 页面显示错误提示
**And** 错误提示说明失败原因
**And** 提供重试按钮
**And** 点击重试按钮后重新加载数据

#### Scenario: 部分图表加载失败
**Given** 用户访问统计页面
**When** 某个图表的API请求失败
**Then** 该图表显示错误提示
**And** 其他图表正常显示
**And** 失败的图表提供重试按钮

### Requirement: 性能要求
系统 MUST 在合理时间内加载和渲染统计页面。

#### Scenario: 页面首次加载性能
**Given** 系统中存在 100 个工作计划
**When** 用户访问统计页面
**Then** 页面在 1s 内完成首次渲染
**And** 所有图表在 1.5s 内完成渲染
**And** 页面不出现明显的卡顿

#### Scenario: 日期切换性能
**Given** 用户访问统计页面
**When** 用户切换日期范围
**Then** 时间趋势图在 500ms 内完成更新
**And** 页面不出现明显的卡顿
**And** 用户可以继续操作其他元素

#### Scenario: 大数据量性能
**Given** 系统中存在 10,000 个工作计划
**When** 用户访问统计页面
**Then** 页面在 2s 内完成首次渲染
**And** 所有图表在 2.5s 内完成渲染
**And** 图表交互保持流畅

### Requirement: 可访问性
系统 MUST 符合可访问性标准,支持键盘导航和屏幕阅读器。

#### Scenario: 键盘导航
**Given** 用户使用键盘访问统计页面
**When** 用户使用 Tab 键导航
**Then** 焦点按逻辑顺序在元素间移动
**And** 焦点元素有明显的视觉指示
**And** 用户可以使用 Enter 键激活按钮和链接

#### Scenario: 屏幕阅读器支持
**Given** 用户使用屏幕阅读器访问统计页面
**When** 屏幕阅读器读取页面内容
**Then** 图表有适当的 ARIA 标签
**And** 图表数据有文本替代方案
**And** 交互元素有清晰的描述

#### Scenario: 颜色对比度
**Given** 用户访问统计页面
**When** 查看页面内容
**Then** 所有文本和背景的颜色对比度符合 WCAG AA 标准
**And** 图表颜色对色盲用户友好
**And** 图表使用图案或标签辅助区分
