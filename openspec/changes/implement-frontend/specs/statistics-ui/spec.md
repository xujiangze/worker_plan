# Spec: Statistics UI

## ADDED Requirements

### Requirement: 统计仪表盘
前端 MUST 提供统计仪表盘页面,显示各种统计图表和关键指标。

#### Scenario: 访问统计仪表盘
**Given** 用户访问统计仪表盘页面 `/statistics`
**When** 页面加载完成
**Then** 系统显示统计仪表盘
**And** 仪表盘包含以下部分:
  - 关键指标卡片
  - 状态分布图表
  - 优先级分布图表
  - 时间趋势图表
  - 完成率显示
**And** 所有图表和指标实时更新

#### Scenario: 显示关键指标
**Given** 用户在统计仪表盘页面
**When** 页面加载完成
**Then** 系统显示关键指标卡片:
  - 总计划数:20
  - 已完成数:12
  - 进行中数:8
  - 待开始数:5
  - 已取消数:1
**And** 每个指标卡片显示:
  - 指标名称
  - 指标数值
  - 图标
  - 趋势箭头(上升/下降)

#### Scenario: 显示状态分布图表
**Given** 用户在统计仪表盘页面
**When** 页面加载完成
**Then** 系统显示状态分布饼图
**And** 图表显示各状态计划的数量和占比:
  - 待开始:5 个(25%)
  - 进行中:8 个(40%)
  - 已完成:6 个(30%)
  - 已取消:1 个(5%)
**And** 图表使用不同颜色区分状态:
  - 待开始:灰色
  - 进行中:蓝色
  - 已完成:绿色
  - 已取消:红色
**And** 图表显示图例

#### Scenario: 显示优先级分布图表
**Given** 用户在统计仪表盘页面
**When** 页面加载完成
**Then** 系统显示优先级分布柱状图
**And** 图表显示各优先级计划的数量和占比:
  - 高优先级:3 个(15%)
  - 中优先级:10 个(50%)
  - 低优先级:7 个(35%)
**And** 图表使用不同颜色区分优先级:
  - 高优先级:红色
  - 中优先级:橙色
  - 低优先级:绿色
**And** 图表显示图例

#### Scenario: 显示时间趋势图表
**Given** 用户在统计仪表盘页面
**When** 页面加载完成
**Then** 系统显示时间趋势折线图
**And** 图表显示每日创建和完成的计划数量
**And** 图表包含两条折线:
  - 创建计划数量(蓝色)
  - 完成计划数量(绿色)
**And** 图表 X 轴显示日期
**And** 图表 Y 轴显示数量
**And** 图表显示图例

#### Scenario: 显示完成率
**Given** 用户在统计仪表盘页面
**When** 页面加载完成
**Then** 系统显示完成率卡片
**And** 卡片显示:
  - 总计划数:20
  - 已完成数:12
  - 完成率:60%
**And** 完成率使用环形进度条显示
**And** 进度条颜色根据完成率变化:
  - 0-30%:红色
  - 31-70%:橙色
  - 71-100%:绿色

#### Scenario: 加载统计数据时显示加载状态
**Given** 用户访问统计仪表盘页面
**When** 数据正在加载
**Then** 系统显示加载动画
**And** 每个图表和指标卡片显示骨架屏
**And** 用户无法进行其他操作

#### Scenario: 空数据显示
**Given** 系统中不存在任何工作计划
**When** 用户访问统计仪表盘页面
**Then** 系统显示空状态提示
**And** 提示信息:"暂无统计数据"
**And** 显示"创建计划"按钮

### Requirement: 时间范围选择
前端 MUST 提供时间范围选择功能,允许用户查看指定时间范围内的统计数据。

#### Scenario: 选择时间范围
**Given** 用户在统计仪表盘页面
**When** 用户点击时间范围选择器
**Then** 系统显示时间范围选项:
  - 本周
  - 本月
  - 本季度
  - 本年
  - 自定义
**When** 用户选择"本月"
**Then** 系统更新所有图表和指标
**And** 统计数据只包含本月创建的计划

#### Scenario: 自定义时间范围
**Given** 用户在统计仪表盘页面
**When** 用户点击时间范围选择器
**And** 用户选择"自定义"
**Then** 系统显示日期范围选择器
**When** 用户选择开始日期:2026-01-01
**And** 用户选择结束日期:2026-01-31
**And** 用户点击"确定"按钮
**Then** 系统更新所有图表和指标
**And** 统计数据只包含指定时间范围内的计划

#### Scenario: 时间范围验证
**Given** 用户在统计仪表盘页面
**When** 用户选择自定义时间范围
**And** 用户选择开始日期:2026-01-31
**And** 用户选择结束日期:2026-01-01
**And** 用户点击"确定"按钮
**Then** 系统显示错误提示:"开始日期不能晚于结束日期"
**And** 时间范围不会更新

### Requirement: 图表交互
前端 MUST 提供图表交互功能,允许用户查看详细信息和筛选数据。

#### Scenario: 悬停显示详细信息
**Given** 用户在统计仪表盘页面
**When** 用户将鼠标悬停在状态分布饼图的某个扇区上
**Then** 系统显示提示框
**And** 提示框显示:
  - 状态名称
  - 计划数量
  - 占比
**And** 提示框跟随鼠标移动

#### Scenario: 点击筛选数据
**Given** 用户在统计仪表盘页面
**When** 用户点击状态分布饼图的某个扇区
**Then** 系统筛选计划列表
**And** 只显示对应状态的计划
**And** 系统跳转到计划列表页面
**And** 筛选条件显示在页面上

#### Scenario: 图表缩放
**Given** 用户在统计仪表盘页面
**When** 用户在时间趋势图表上使用鼠标滚轮
**Then** 图表放大或缩小
**And** X 轴显示更多或更少的日期
**And** 用户可以拖动图表查看不同时间段

#### Scenario: 图表导出
**Given** 用户在统计仪表盘页面
**When** 用户点击图表右上角的"导出"按钮
**Then** 系统显示导出选项:
  - 导出为 PNG 图片
  - 导出为 PDF 文件
**When** 用户选择"导出为 PNG 图片"
**Then** 系统下载图表的 PNG 图片

### Requirement: 数据刷新
前端 MUST 提供数据刷新功能,允许用户手动刷新统计数据。

#### Scenario: 手动刷新数据
**Given** 用户在统计仪表盘页面
**When** 用户点击"刷新"按钮
**Then** 系统重新请求所有统计数据
**And** 系统显示加载动画
**And** 数据加载完成后,图表和指标更新
**And** 系统显示成功提示:"数据已刷新"

#### Scenario: 自动刷新数据
**Given** 用户在统计仪表盘页面
**When** 用户启用自动刷新功能
**Then** 系统每隔 5 分钟自动刷新数据
**And** 页面顶部显示"自动刷新:开启"提示
**When** 用户禁用自动刷新功能
**Then** 系统停止自动刷新
**And** 页面顶部显示"自动刷新:关闭"提示

### Requirement: 响应式图表
前端 MUST 支持响应式图表,适配不同屏幕尺寸。

#### Scenario: 桌面端图表显示
**Given** 用户使用桌面设备(屏幕宽度 ≥ 1200px)
**When** 用户访问统计仪表盘页面
**Then** 系统显示 2 列布局
**And** 左侧显示关键指标卡片
**And** 右侧显示图表
**And** 图表显示完整信息

#### Scenario: 平板端图表显示
**Given** 用户使用平板设备(屏幕宽度 768px - 1199px)
**When** 用户访问统计仪表盘页面
**Then** 系统显示 1 列布局
**And** 关键指标卡片显示在顶部
**And** 图表显示在下方
**And** 图表适当缩小

#### Scenario: 移动端图表显示
**Given** 用户使用移动设备(屏幕宽度 < 768px)
**When** 用户访问统计仪表盘页面
**Then** 系统显示 1 列布局
**And** 关键指标卡片显示在顶部
**And** 图表垂直排列
**And** 图表简化显示,隐藏次要信息

### Requirement: 图表性能优化
前端 MUST 优化图表性能,确保大数据量下的流畅体验。

#### Scenario: 大数据量下的图表渲染
**Given** 系统中有 10,000 个工作计划
**When** 用户访问统计仪表盘页面
**Then** 系统在 2 秒内完成图表渲染
**And** 图表流畅显示,无卡顿

#### Scenario: 图表数据采样
**Given** 系统中有 10,000 个工作计划
**When** 用户访问统计仪表盘页面
**Then** 时间趋势图表对数据进行采样
**And** 每天显示最多 100 个数据点
**And** 图表保持可读性

#### Scenario: 图表懒加载
**Given** 用户访问统计仪表盘页面
**When** 页面加载完成
**Then** 系统优先加载关键指标卡片
**And** 图表按需加载
**And** 用户滚动到图表位置时才加载图表
